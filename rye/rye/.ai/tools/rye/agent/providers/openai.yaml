# rye:signed:2026-02-20T01:09:07Z:29f149c2149707738f79075e3857ca915c9e103589ea9b7078c8a7d26d7cfadc:q_ZTdfR7majF0f74Wq_Ea95NcD5MLvND13pwmfrVoa6cgkHnxI73jhPJAG9aB6ZkBynQEUB9iwszP8-el1xICw==:440443d0858f0199
tool_id: openai
tool_type: http
version: "1.0.0"
description: "OpenAI Chat Completions API provider for thread execution"
executor_id: rye/core/primitives/http_client
category: rye/agent/providers

requires:
  - net.call

tier_mapping:
  fast: "gpt-4o-mini"
  general: "gpt-4o-mini"
  high: "gpt-4o"
  max: "o3"

# Per-million-token pricing (USD)
pricing:
  gpt-4o:
    input: 2.50
    output: 10.00
  gpt-4o-mini:
    input: 0.15
    output: 0.60
  o3:
    input: 2.00
    output: 8.00
  o3-mini:
    input: 1.10
    output: 4.40
  o4-mini:
    input: 1.10
    output: 4.40

env_config:
  env:
    OPENAI_API_KEY: "${OPENAI_API_KEY}"

config:
  method: POST
  url: "https://api.openai.com/v1/chat/completions"

  auth:
    type: bearer
    token: "${OPENAI_API_KEY}"

  headers:
    Content-Type: application/json

  body:
    model: "{model}"
    max_tokens: "{max_tokens}"
    messages: "{messages}"
    tools: "{tools}"

  timeout: 120

  retry:
    max_attempts: 2
    backoff: exponential

parameters:
  - name: model
    type: string
    required: true
    default: "gpt-4o-mini"
  - name: max_tokens
    type: integer
    required: false
    default: 4096
  - name: messages
    type: array
    required: true
    description: "Array of {role, content} message objects"
  - name: tools
    type: array
    required: false
    default: []
    description: "Array of tool definitions for function calling"

tool_use:
  mode: native
  response_format: chat_completion

  tool_definition:
    type: function
    function:
      name: "{name}"
      description: "{description}"
      parameters: "{schema}"

  response:
    tool_call_type: function
    stop_reason_field: finish_reason
    stop_reason_tool_use: tool_calls

  tool_result:
    role: tool
    id_field: tool_call_id
    content_field: content
