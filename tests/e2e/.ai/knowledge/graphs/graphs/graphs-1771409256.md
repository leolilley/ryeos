<!-- rye:signed:2026-02-18T10:07:41Z:927204ebaf42bcbc3830359005b6bec9386863bddcef7debc4bfe138fd99c631:T2w8VKyJN7nESz50lDKxHEAoVklVzg36BxBz7bZA2vuurNwPK0yiCn2Y2fejd7CIiFJzejK6ZqlIeb7DVtaACg==:440443d0858f0199 -->
```yaml
name: graphs/graphs/graphs-1771409256
title: "State: graphs (graphs-1771409256)"
entry_type: graph_state
category: graphs/graphs
version: "1.0.0"
graph_id: graphs
graph_run_id: graphs-1771409256
parent_thread_id: 
status: completed
current_node: done
step_count: 5
updated_at: 2026-02-18T10:07:41Z
tags: [graph_state]
```

{
  "inputs": {
    "file_path": "graph-output/full-review/samples/utils.py",
    "output_dir": "graph-output/sync-test",
    "capabilities": [
      "rye.execute.tool.*",
      "rye.execute.directive.*",
      "rye.search.*",
      "rye.load.*",
      "rye.sign.*"
    ],
    "depth": 5
  },
  "source_code": "import hashlib\nimport hmac\nimport os\nfrom typing import Optional\n\ndef generate_token(length: int = 32) -> str:\n    return os.urandom(length).hex()\n\ndef hash_password(password: str, salt: Optional[str] = None) -> tuple:\n    if salt is None:\n        salt = os.urandom(16).hex()\n    hashed = hashlib.pbkdf2_hmac('sha256', password.encode(), salt.encode(), 100000)\n    return hashed.hex(), salt\n\ndef verify_password(password: str, hashed: str, salt: str) -> bool:\n    new_hash, _ = hash_password(password, salt)\n    return hmac.compare_digest(new_hash, hashed)\n\ndef sanitize_input(text: str) -> str:\n    dangerous = ['<script>', '</script>', 'javascript:', 'onerror=']\n    result = text\n    for pattern in dangerous:\n        result = result.replace(pattern, '')\n    return result.strip()\n",
  "analysis_result": "I'll execute this directive step by step. Let me analyze the code and write the results.\n\nFirst, let me analyze the code snippet:\n- **Language**: Python\n- **Function count**: 4 functions (generate_token, hash_password, verify_password, sanitize_input)\n- **Summary**: The code provides security utilities for token generation, password hashing with salt using PBKDF2-HMAC-SHA256, password verification using constant-time comparison, and basic input sanitization by removing common XSS-related patterns from text.\n\nNow I'll execute the steps:",
  "thread_id": "test/graphs/analyze_code-1771409257",
  "analysis_json": "{\"language\": \"Python\", \"function_count\": 4, \"summary\": \"This code provides security utilities including token generation, password hashing with salt using PBKDF2-HMAC-SHA256 with 100,000 iterations, password verification using constant-time comparison to prevent timing attacks, and basic input sanitization to remove common XSS-related patterns from text.\"}",
  "report_written": true
}