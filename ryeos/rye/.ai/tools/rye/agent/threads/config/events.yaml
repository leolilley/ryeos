# rye:signed:2026-02-21T05:56:40Z:9a8b3e1b54d989f12b82d54a74febe676fbe90e13433a2665a7e77968424851c:ZvbKhkdOFRg9tf93D6Ms0sDVFQZ6BvoLw73MAbFB954u2OEnJIjmg6ymM9h1fTWIIXutKp5WlNA-P22zr_cbBA==:9fbfabe975fa5a7f
# config/events.yaml
category: "rye/agent/threads/config"
tool_type: "config"
version: "1.0.0"
description: "Thread event type definitions, payload schemas, and criticality levels"
schema_version: "1.0.0"

event_types:
  thread_started:
    category: lifecycle
    criticality: critical
    description: "Thread execution begins"
    payload_schema:
      type: object
      required: [directive, model]
      properties:
        directive: { type: string }
        model: { type: string }
        limits: { type: object }

  thread_completed:
    category: lifecycle
    criticality: critical
    payload_schema:
      type: object
      required: [cost]
      properties:
        cost: { type: object }

  thread_suspended:
    category: lifecycle
    criticality: critical
    payload_schema:
      type: object
      required: [suspend_reason]
      properties:
        suspend_reason: { type: string, enum: [limit, error, budget, approval] }

  thread_cancelled:
    category: lifecycle
    criticality: critical
    payload_schema:
      type: object
      properties:
        reason: { type: string }

  cognition_in:
    category: cognition
    criticality: critical
    description: "Prompt sent to LLM"
    payload_schema:
      type: object
      required: [text, role]
      properties:
        text: { type: string }
        role: { type: string, enum: [system, user, developer] }
        directive: { type: string }

  cognition_out:
    category: cognition
    criticality: critical
    emit_on_error: true
    payload_schema:
      type: object
      required: [text]
      properties:
        text: { type: string }
        model: { type: string }
        is_partial: { type: boolean, default: false }
        truncated: { type: boolean, default: false }
        error: { type: string }
        completion_percentage: { type: number, minimum: 0, maximum: 100 }

  cognition_out_delta:
    category: cognition
    criticality: droppable
    description: "Streaming text chunk"
    emit_config:
      async: true
      throttle_seconds: 0.1
    payload_schema:
      type: object
      required: [text]
      properties:
        text: { type: string }
        chunk_index: { type: integer }
        is_final: { type: boolean }

  cognition_reasoning:
    category: cognition
    criticality: droppable
    emit_on_error: true
    emit_config:
      accumulate_on_error: true
    payload_schema:
      type: object
      required: [text]
      properties:
        text: { type: string }
        is_partial: { type: boolean }
        was_interrupted: { type: boolean }

  tool_call_start:
    category: tool
    criticality: critical
    payload_schema:
      type: object
      required: [tool, call_id, input]
      properties:
        tool: { type: string }
        call_id: { type: string }
        input: { type: object }

  tool_call_result:
    category: tool
    criticality: critical
    payload_schema:
      type: object
      required: [call_id]
      properties:
        call_id: { type: string }
        output: { type: string }
        error: { type: string }
        duration_ms: { type: integer }

  error_classified:
    category: error
    criticality: critical
    payload_schema:
      type: object
      required: [error_code, category]
      properties:
        error_code: { type: string }
        category: { type: string }
        retryable: { type: boolean }

  limit_escalation_requested:
    category: error
    criticality: critical
    payload_schema:
      type: object
      required: [limit_code]
      properties:
        limit_code: { type: string }
        current_value: { type: number }
        current_max: { type: number }

  child_thread_started:
    category: orchestration
    criticality: critical
    payload_schema:
      type: object
      required: [child_thread_id, child_directive]
      properties:
        child_thread_id: { type: string }
        child_directive: { type: string }
        parent_thread_id: { type: string }

criticality_levels:
  critical:
    description: "Synchronous, blocking write"
    durability: guaranteed
    async: false

  droppable:
    description: "Fire-and-forget async emission"
    durability: best_effort
    async: true
    fallback: drop
